<template name="dataRoom">
  <div class="list-view flex-tab__header">
      <div class="title">
        <h2>{{_ "Data Room"}}</h2>
      </div>
      {{#if hasPermission 'AddFolder'}}<button class="button add-dir"><span>Add Folder</span></button>{{/if}}
      {{#if hasPermission 'AddDoc'}}<button class="button add-file"><span>Add File</span></button>{{/if}}
    </div>
    <div class="uploaded-files-list list-view flex-tab__result js-list">
      <ul class="list clearfix lines">
        {{#each getDirs}}
          <li id="{{_id}}" class="room-file-dir">
              <i class="icon-folder-open"></i><p id="{{_id}}" class="dir-name">{{name}} {{#if hasPermission 'ChangePermission'}}<i id="{{_id}}" class="icon-cog dir-permission"></i>{{/if}}</p>
          </li>
          {{> dirs dataRoom=dataRoom permissions=permissions dir=this}}
        {{/each}}
        {{#each files}}
          {{> hubFile}}
        {{/each}}
      </ul>
    </div>
    {{> fileUpload}}
    {{> dataRoomPermissions}}
</template>

<template name="dirs">
  {{#each getDirs}}
    <li id="{{_id}}" class="room-file-dir">
        <i class="icon-folder-open"></i><p id="{{_id}}" class="dir-name">{{name}} {{#if hasPermission 'ChangePermission'}}<i id="{{_id}}" class="icon-cog dir-permission"></i>{{/if}}</p>
    </li>
    {{> dirs dataRoom=dataRoom permissions=permissions dir=this}}
  {{/each}}
  {{#each files}}
    {{> hubFile permissions=permissions file=this}}
  {{/each}}
</template>

<template name="hubFile">
  {{#with file}}
  {{#if hasPermission 'ViewDoc'}}
  <li>
    {{#if hasPermission 'RemoveFile'}}
    <i class="icon-trash file-delete"></i>
    {{/if}}
    {{#if hasPermission 'ChangePermission'}}
    <i id="{{_id}}" class="icon-cog file-permission"></i>
    {{/if}}
    {{#if hasPermission 'DownloadDoc'}}
    <a title="{{escapedName}}" href="{{url}}" target="_blank" class="file-download" download="">
      <i class="icon-download file-download"></i>
    </a>
    {{/if}}
    <a title="{{escapedName}}" class="room-file-item file-name">
      <i class="{{getFileIcon type}}"></i>
      <p>{{displayName}}</p>
    </a>
  </li>
  {{/if}}
  {{/with}}
</template>